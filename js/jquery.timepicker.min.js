Date.prototype.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];Date.prototype.getMonthName=function(){return this.monthNames[this.getMonth()]};Date.prototype.getShortMonthName=function(){return this.getMonthName().substr(0,3)};Date.prototype.dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];Date.prototype.getDayName=function(){return this.dayNames[this.getDay()]};Date.prototype.getShortDayName=function(){return this.getDayName().substr(0,3)};Date.prototype.toMysqlDate=function(){function e(e){return 0<=e&&e<10?"0"+e.toString():-10<e&&e<0?"-0"+(-1*e).toString():e.toString()}return this.getUTCFullYear()+"-"+e(1+this.getUTCMonth())+"-"+e(this.getUTCDate())};(function(e){e.fn.timePicker=function(t){function n(e,t){e=e.replace("shortMonthName",t.getShortMonthName());e=e.replace("monthName",t.getMonthName());e=e.replace("shortDayName",t.getShortDayName());e=e.replace("dayName",t.getDayName());e=e.replace("date",t.getDate());return e}function r(t,r){for(var i=o.datePicker.numOfDates;i>0;i--){var s=e(o.datePicker.date.html);s.addClass(o.datePicker.date.className).attr("data-date",r.getTime()).attr("data-tp-role","datePickerDate").html(n(o.datePicker.date.text,r)).appendTo(t);undefined!==e.fn.timePicker.variables.selectedDatesArr[r.getTime()]&&s.addClass(o.datePicker.date.selectedClassName);r.setDate(r.getDate()+1);o.datePicker.dates.added.call(e("[data-tp-role=datePickerDate]",t))}}function i(t,r){""!==o.timePicker.wrapper.htmlBefore&&e("[data-tp-role=timePickerHtmlBefore]",t).length===0&&e(o.timePicker.wrapper.htmlBefore).attr("data-tp-role","timePickerHtmlBefore").prependTo(t);var i=e(o.timePicker.time.html);i.addClass(o.timePicker.time.className).attr("data-date",r.getTime()).attr("data-tp-role","timePickerTime").html(n(o.timePicker.time.text,r));e('<input type="hidden" name="'+o.fieldName+"["+r.getTime()+"]["+o.datePicker.date.hiddenFieldName+']" value="'+r.toMysqlDate()+'" />').appendTo(i);var s=e("<select></select>");s.attr("name",o.fieldName+"["+r.getTime()+"]["+o.timePicker.time.selectFieldName+"]").appendTo(i);var u=e.fn.timePicker.createFriendlyTimesArr(o.timePicker.time.startTime,o.timePicker.time.endTime,o.timePicker.time.interval);for(var a in u){var f=e('<option value="'+a+'">'+u[a]+"</option>");u[a]===o.timePicker.time.preSelected&&f.prop("selected","selected");f.appendTo(s)}var l=!1;e("[data-tp-role=timePickerTime]",t).each(function(){if(e(this).attr("data-date")>r.getTime()){i.insertBefore(this);l=!0;return!1}});l||i.appendTo(t);o.timePicker.time.added.call(i)}function s(t,n){e("[data-date="+n.getTime()+"]",t).remove();e("[data-tp-role=timePickerTime]",t).length===0&&t.empty();o.timePicker.time.removed.call(t)}var o=e.extend(!0,{},e.fn.timePicker.defaults,t);return this.each(function(){var t=e(this).empty(),n=e(o.datePicker.wrapper.html);""!==o.datePicker.wrapper.htmlBefore&&e(o.datePicker.wrapper.htmlBefore).attr("data-tp-role","datePickerHtmlBefore").appendTo(n);n.addClass(o.datePicker.wrapper.className).attr("data-tp-role","datePicker").appendTo(t);var u=e(o.datePicker.prev.html);u.addClass(o.datePicker.prev.className).attr("data-tp-role","datePickerPrev").html(o.datePicker.prev.text).on("click",function(){o.datePicker.prev.clicked.call(e(this));var t=e("[data-tp-role=datePickerDate]:first",n),i=parseInt(t.attr("data-date"),10),s=new Date(i);if(!o.datePicker.allowPastDates&&s.toDateString()===e.fn.timePicker.variables.now.toDateString())return!1;if(!o.datePicker.allowPastDates&&s<e.fn.timePicker.variables.now)return!1;a.empty();s.setDate(s.getDate()-1);r(a,s);o.datePicker.prev.finished.call(e(this))}).appendTo(n);var a=e(o.datePicker.dates.html);a.addClass(o.datePicker.dates.className).attr("data-tp-role","datePickerDates").on("click","[data-tp-role=datePickerDate]",function(){o.datePicker.date.clicked.call(e(this));var t=0;for(var n in e.fn.timePicker.variables.selectedDatesArr)t++;var r=e(this),u=parseInt(r.attr("data-date"),10);if(undefined===e.fn.timePicker.variables.selectedDatesArr[u]){if(t>=o.numberOfTimes)return!1;e.fn.timePicker.variables.selectedDatesArr[u]=1;i(l,new Date(u))}else{delete e.fn.timePicker.variables.selectedDatesArr[u];s(l,new Date(u))}o.datePicker.date.addSelectedClassOnClick&&r.toggleClass(o.datePicker.date.selectedClassName);o.datePicker.date.finished.call(e(this))}).appendTo(n);var f=e(o.datePicker.next.html);f.addClass(o.datePicker.next.className).attr("data-tp-role","datePickerNext").html(o.datePicker.next.text).on("click",function(){o.datePicker.next.clicked.call(e(this));var t=e("[data-tp-role=datePickerDate]:first",n),i=parseInt(t.attr("data-date"),10),s=new Date(i);a.empty();s.setDate(s.getDate()+1);r(a,s);o.datePicker.next.finished.call(e(this))}).appendTo(n);var l=e(o.timePicker.wrapper.html);l.addClass(o.timePicker.wrapper.className).attr("data-tp-role","timePicker").appendTo(t);r(a,new Date(e.fn.timePicker.variables.now.getTime()))})};e.fn.timePicker.defaults={numberOfTimes:3,fieldName:"schedule",datePicker:{numOfDates:5,allowPastDates:!1,wrapper:{htmlBefore:'<p class="TPDatePickerHtmlBefore">First, choose three dates:</p>',html:"<div />",className:"TPDatePicker"},prev:{className:"TPDatePickerPrev",html:"<span />",text:"&#9664;",clicked:function(){},finished:function(){}},dates:{className:"TPDatePickerDates",html:"<span />",added:function(){}},date:{className:"TPDatePickerDate",selectedClassName:"selected",addSelectedClassOnClick:!0,hiddenFieldName:"date",html:"<span />",text:"<small>shortMonthName</small> <b>date</b> <small>shortDayName</small>",clicked:function(){},finished:function(){}},next:{className:"TPDatePickerNext",html:"<span />",text:"&#9654;",clicked:function(){},finished:function(){}}},timePicker:{wrapper:{htmlBefore:'<p class="TPTimePickerHtmlBefore">Now, please select your available times:</p>',html:"<div />",className:"TPTimePicker"},time:{className:"TPTimePickerTime",preSelected:"7:00am",startTime:"6:00",endTime:"19:00",interval:15,selectFieldName:"time",html:"<span />",text:"<small>shortMonthName</small> <b>date</b> <small>shortDayName</small>",added:function(){},removed:function(){}}}};e.fn.timePicker.variables={selectedDatesArr:[],now:new Date};e.fn.timePicker.createDateObjFromTime=function(e,t){function n(e){return!isNaN(parseFloat(e))&&isFinite(e)}var r=e.split(":");r[0]=n(r[0])?parseInt(r[0],10):0;r[1]=n(r[1])?parseInt(r[1],10):0;r[2]=n(r[2])?parseInt(r[2],10):0;undefined===t&&(t=new Date);t.setHours(r[0]);t.setMinutes(r[1]);t.setSeconds(r[2]);return t};e.fn.timePicker.createFriendlyTimesArr=function(t,n,r){function i(e){return e.length===1?"0"+e:e}undefined===t&&(t="00:00");var s=e.fn.timePicker.createDateObjFromTime(t),o=e.fn.timePicker.createDateObjFromTime(n),u=[];while(o>=s){var a=i(""+s.getMinutes()),f=s.getHours(),l=i(""+f)+":"+a;f===0?f="12:"+a+"am":f<12?f=f+":"+a+"am":f===12?f="12:"+a+"pm":f=f-12+":"+a+"pm";u[l]=f;s.setTime(s.getTime()+r*60*1e3)}return u}})(jQuery);